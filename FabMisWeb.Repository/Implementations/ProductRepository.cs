using FabMisWeb.Model;
using FabMisWeb.Repository.Contracts;
using Microsoft.Extensions.Options;
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.Text;

namespace FabMisWeb.Repository.Implementations
{
    public class ProductRepository : IProductRepository
    {
        private IOptions<WebConfiguration> _options;

        public ProductRepository(IOptions<WebConfiguration> options)
        {
            _options = options;
        }

        public DataSet GetProductListData()
        {
            DataSet ds = new DataSet();

            try
            {
                using (SqlConnection con = new SqlConnection(_options.Value.DefaultConnection))
                {
                    using (SqlCommand cmd = con.CreateCommand())
                    {
                        cmd.CommandText = "[FabMIS].[rptProductList]";
                        cmd.CommandType = CommandType.StoredProcedure;
                        cmd.CommandTimeout = 0;
                        cmd.Parameters.Add("@PromoCodes", SqlDbType.VarChar).Value = "59,85,69,49,76,15,78,11,9,60,18,20,23,2,79,55,46,19,81,33,44,32,77,40,30,25,8,3,24,86,28,21,70,1,84,27,61,83,7,37,10,12,17,5,4,6,31,63,71,62,14,36,43,34,48,65,47,82,50,13,68,67,66,64,56,42,41,39,87,38,80,45,26,22,16,57,35,29,75,74,73,72,53,52,51,54,0";
                        cmd.Parameters.Add("@PHCodes", SqlDbType.VarChar).Value = "AH08,AM09,BA13,BJ10,CN15,DL11,DL16,DMPH,AP14,CH07,JA02,JD03,KL05,PSCPH,QCPH";
                        cmd.Parameters.Add("@VendorCodes", SqlDbType.VarChar).Value = "0,5EL,ABAE,ABTU,MIG108,ALINE,MIG113,AMFAB,AAMMUD,ADT,AKTEXT,ARF,ADTM,MIG106,MIG104,AAGOR,MIG111,AHF,ALKOLI,AROHI,ARHENT,AARART,ASWRI,MIG169,ASIFAN,ASMAHL,AVRN,ABHDLM,ABHAF,ABDMAJ,Razaqu,ARKK,ABVAH,ABHPUB,ABHI,ABP,ABUBHL,ACNEX,ADARSH,ADIART,ADMK,AF,ADIT,MIG115,AITEX,AESH,AFYA,AFTHL,AGRC,AVBR,AJADEN,AKFSHN,AKHL,AAMS,AKTAH,MIG110,AKHF,AKMD,AKSHA,AKEN,MIG109,AKPR,MIG112,ALUMER,ALAEXP,ALC,APCD,MIG114,ADPL,AIHL,ALCON,MIG103,ALWE,MIG182,Alok,ALOR,ALTH,AMA,AMANHL,AMHF,AMANIA,AMIH,MIG118,MIG116,AMBGAR,AMBEY,MIG101,AMHL,MIG117,AMIN,AMRH,AMPRNT,AMT,ARBIND,ANANT,ANMS,MIG119,Angika,ANAMD,ANJAN,ANJTP,ANKUR,ANMGMT,ANSILK,MIG121,ANNU,ANCR,MIG122,ANSHL,MIG125,ANENT,ANHF,ANHLF,MIG107,MIG124,ANUBAR,ANUR,MIG126,MIG105,ANUDAS,APDSGN,APUORG,ARN,AEC,ARIFHL,ARPAUL,ARJHC,ARJNKL,ARKAY,JAWAJA,ARCH,ARNEXP,ARBS,ARVIND,ARV,ASHL,ASADHL,ASRAM,ASHALF,MIG129,ASKB,ASHDAS,ASHOKA,ASHWIP,MIG130,MIG132,ASHWL,AFAB,APE,ASIFAB,MIG128,ASRAR,ASCC,MIG127,ASG,OARK,AVPP,AVIND,AVANTI,ASP,AVNID,AVNS,AYNTX,AYRA,AYNAT,AZTEX,MIG134,AZHR,MIG135,AZUDIN,AZCR,MIG136,AZHLF,MIG137,BNGRVA,MIG147,BABABH,BABYHL,MIG139,BAIDYA,BAAGRO,BVWM,MIG142,BANHFT,MIG144,BNSHL,MIG141,TANTU,BHPRNT,MIG145,BRQE,MIG143,BASANT,BFKTRI,BHCDS,BEROZ,BOPT,BHARAT,BHRT,BSDC,BHHLH,Bhavya,BHRIGU,MIG146,BHUIRA,BYeldi,Bidhan,MIG140,Bikash,BMFPL,BB,Babu,BLISS,BODHSW,BRFL,BKSADH,BRBMB,BREEZE,MIG148,BRIC,MIG138,KL05-DP,BUNKAR,BVSCH,BUSHHF,BUSHRA,BUSHU,CRTEX,CCPL,CALY,MIG150,CANCON,MIG151,CSAFNA,CEEDAA,CNTUHL,CHAI,MIG153,CHMNTX,MIG157,CHAMKI,MIG156,CHAMPA,CSPTLT,CHRCOL,CHKHL,CHBNDI,CHHLF,MIG154,MIG149,CHAPAN,CHRCHN,CHCOW,MIG155,MIG152,CHYY,CSWS,CHROME,CHUI,CSTH,MIG158,COCO,CODINC,COMBII,COMPJW,Cnftti,CONFOD,MIG159,COTNHL,COTIND,COTROU,CAF,CTSANK,CWTE,MIG160,DAMODE,DAHJ,MIG164,MIG231,MIG165,MIG235,DAKSA,DART,DANTEX,MIG167,DNTALA,DANYAL,DOTEA,DAMA,MIG166,DATA,DAYABD,DECO,DD,DKC,DEEPNC,DL16-DP,DELTEX,MIG177,MIG174,DRWJIL,MIG163,dah,DESI,MIG171,DARPAN,DESELE,MIG170,DEHOME,MIG176,DBPUB,Deva,DBHUMI,DEVEN,DEVIS,MIG172,DHANLX,DHANOP,DSCS,DT,DKL,MIG168,DIMDE,DIMPLE,MIG185,DINESH,MIG161,DWGDI,DIVDGN,VGDL,DIXIEN,DIDE,DKHL,MIG173,MIG427,DREART,DURENT,MIG162,DURHL,DURTEX,MIG178,DWK,DWJW,MIG179,DSJ,EARACC,EART,SEET,ENRS,ECOFAB,ECO,ECOTSR,ECOBUD,DARB,Eden,MIG181,ELN,MIG183,ESSMA,KMSD,ELXFPL,FACC,FBSTH,MIG189,FABSHG,MIG186,FAIPL,FBST,FHHL,FAHMHL,MIG187,FASL,FAHLF,MIG197,FAIZCR,FAIZAN,FKHR,MIG190,FARNHL,FRDB,FSNWR,MIG188,FerroL,FIVEHL,FLAME,MIG191,FLORA,MIG192,FMTEX,FOREVR,MIG195,FRAGWD,FSTEX,MIG196,FRODGN,FURKAN,FRQHL,MIG194,GAGLH,MIG199,MIG200,MIG203,GAYA,MIG201,GYHL,MIG208,GYTR,PC,GKK,GEHLOT,GEMS,MIG205,GJKSHE,MIG202,GLIMPS,MIG204,GFFPL,GGLORY,GMHL,GLHND,GOKHL,GolFib,GOLDHL,MIG206,GOPSAN,GHPL,GOVOPL,GRAMYA,MIG207,GREATX,GRNETH,GUNTEX,GPTEX,GVCORP,GVSARI,HBENTP,HFIZHL,HFIZKM,MIG210,HAJIEB,MIG212,HMC,HTI,HMZAHL,HNDCRT,HANMAN,HLCRFT,MIG211,HANICS,HWVIND,HARKOL,HARGKB,Haridb,HARIOM,HARITR,HRJCRF,HARMNY,HRTEX,HHSENH,HASHL,HEIAGA,HEMKL,MIG214,HMNT,HEMRAJ,HPF,HTC,HFAPP,HIMART,MIG215,HIMHL,MIG213,HINA,HINDAE,MIG209,HMTHAL,HDL,HOMEPL,HORZ,HOT,HSPS,HUNAR,HYMNS,IKRAM,Ilyaas,IMRAN,IMRHLF,MIG218,INTRAD,INDSN,INDEX,MIG216,IAC,INCRFT,INCOOP,INDOCN,ITH,INDTEX,MIG219,INDWVE,MIG226,INDICR,INDGCL,MIG227,INDGHF,INDSPR,MIG230,INDUS,MIG221,INFRA,MIG223,INHERE,INHRT,MIG224,INKA,MIG225,INTWVE,INTERS,IQBLHL,IQBLTX,MIG228,IRFNHL,IRFENT,IRSD,MIG229,MIG217,IEXP,ISLAMU,IMK,ISMILE,ISRAR,ISRRHL,IML,MIG240,JABBAR,JAGHL,MIG236,JAG,JHIND,MIG238,JSBI,JFAB,JNC,JCAWPL,JPRWVN,JALA,MIG233,Jamal,JANHTH,HOPINT,JVDTEX,MIG242,JLA,JAYENC,MIG234,MIG237,JAYGEE,JSTEX,MIG241,JNKS,JKHL,JISPAT,MIG239,JUBTEX,JUNO,JIT,JDEXPL,KBHL,MIG246,MIG253,KKFAB,KKUMAR,KSAHL,KAINTL,MIG245,KSAHLF,MIG260,KAINT,KDMHT,KAGACR,KALABH,KLRK,KDHLUG,KALORG,KALMCR,KRTC,KALANI,MIG247,KHPL,KLYNHL,KSF,KAMTEX,MIG256,KAMHL,MIG243,KANA,KHKL,KARTRA,KARLTD,MIG263,KARWEV,KARGRI,KARFAS,MIG232,KRMOVS,MIG255,KKGSS,KAROMI,Kartar,MIG254,KBKL05,KEC,Kashif,KSHYPS,MIG244,KASMHL,MIG261,KAVFAB,KHI,kazage,KBGURD,KGNSSS,KTPL,KHLQ,KCS,KHATI,MIG248,MIG250,KAKY,KARARA,KARB,KARA,ABDUL,MIG102,ADAMAJ,KDNPW,MIG249,KHJA,IRFAN,KMHU,KMSK,KMHM,HANIF,KMUSAT,KNAJ,KSUA,KHUR,MIG251,KIMAAB,KINFAB,KIRPER,KLKOLI,MIG257,KNSENT,KOHTEX,KOLHLC,KOSHL,KWWO,KRAFTP,KRGNAG,KRISH,KRISHO,KRISHN,KRISTX,KRICOl,KC,KIRSCR,KRNFBS,KRHL,MIG258,KWL,KRWFAC,MIG259,KSL,RKHL,KULKR,KAK,KUMSS,KUMAON,KGU,MIG262,LAIBA,LAKRAO,LCD,LALARM,LAMRIN,MIG268,LATUDE,LAXINT,LFPL,LBSIMP,MIG266,LIBCR,MIG264,LLA,LIMHL,MIG267,MIG270,LIYQHL,LOTUSV,LHC,LCG,LCKH,MIG265,LUKHL,MIG269,LUXMI,MKENT,MIG284,MVTHL,MJABIR,MKAHLF,MKHDLM,MKEOKH,MKTH,MMFAB,MPKVIB,MIG289,MIG290,ABHICR,AANSRI,CECIL,DASMAT,FANKAR,INDEVA,MIG222,KUMASS,MIG252,NDS,MIG321,RKHDLM,RWTCRT,SHIVJW,ZNW,ZEBRA,RR,FISCHR,MIG193,FRDSHL,MAATIK,MADONA,MIG273,ATDP,MIG295,MBJA,MSB,MDHBPR,MDHPR,MAHADV,MIG278,MHBB,MHSBRO,MUPC,MAKAIB,MALANI,MIG281,MALVKA,Malik,MALKHA,MLKHFB,MNDL,MIG274,MIG280,MINK,MNSHIN,MHPRNT,MIG279,KAM,MARG,MARUTI,MASTEX,MIG271,MAULTX,MIG283,MAVIN,MAXIDE,MAYASS,MAYBZR,MAYANK,MIG297,MAYOOR,MIG272,MAYUR,MIG287,MQB,MYRART,MIG296,MTEX,MDFRKN,MDND,MIG275,MIG276,MEGACF,MIG277,MCPPL,MERUDJ,METICS,MHRU,MILAN,MILNHL,MIRSAG,MITTAL,MIG292,MMHLMS,MNG,MNMFAB,MOHZAL,MHDAQ,MDZAKI,MHBP,MOHSIN,MIG429,JAFAR,ISMAIL,YUSUF,MDNAEM,MDHU,MIG430,MILYAS,MWE,MONAPA,MIG286,MOONY,MORARK,MIG285,MCH,MOTMAL,MIG291,MP,MPTEX,NSKOLI,MRID,MIG288,MKE,MSHL,MSTEX,MSPENT,MUFEED,MUJFF,MULB,MIG282,MCPL,MIG294,MUNNA,MUNSHA,MURALI,MURSHF,Sonia,MUSKAN,MIG293,MUSTKM,MIG123,MVHL,MYYRA,NAE,NMINT,NSNDRM,MIG314,NKFPL,NMTEXL,MIG311,NAAZHL,MIG304,NABIJN,MIG305,NAEEM,NAFEES,MIG300,Nagari,NAJFHL,MIG308,NANDES,NANDEE,NANDHL,Nanni,NAQASH,NKB,NRENDR,NARGHL,NASEEM,NSMAHL,NANSRI,MIG303,NKHAN,NHENT,MIG180,NBBPPL,NTFB,MIG315,MIG299,Nature,NATURL,NTS,NAHL,MIG301,NAVRTN,MIG298,NCCREX,NCLAGR,MLNGH,NERAKU,NEHFAB,NEHAFB,MIG307,NHSC,NWAH,NBVH,NEIHL,NEWLKF,NEWSUN,MIG313,NIDAHL,MIG309,NIDA,NDDJ,MIG306,NKKP,MIG310,MIG302,NINI,NISHA,NCDAS,NTNSLK,NIZMHL,NOBEL,NOORHL,MIG312,NOOR,NOORTR,NOURSH,NSTOYS,NSK,NFKL,OAK,MIG319,OCHRE,OCMIL,OCT,OJAS,MIG317,OLDCRA,OMARIH,OHW,OMPRKS,OMPRK,OPUL,ORCON,MIG316,OI,OR18,MIG318,OSRJWL,OUTDOR,OVEREX,MIG320,PNGHAL,PALA,PAMECH,MIG328,PANDEY,PHPRNT,MIG323,PANVU,PARAMI,PARA,PBKB,PTKTRI,PRVJHL,PPHWCS,PASAHL,PTRN,PAULTX,PAUUSE,PAWANI,MIG324,PKK,PAWANS,PENGUN,PRERNA,PERFHF,MIG322,PHALDA,PHULKR,MIG175,PIGMNT,PNETES,PIONER,MIG220,PMS1,POCHHL,MIG326,POONAM,MIG327,POOTEX,PAA,POTLIS,PRACHI,Prabha,PRBHUD,PRACHN,PPUDYG,PRAKSH,PSWAMI,PRNSLK,PRANOF,PRNPUR,PRAKAL,MIG325,PRENT,PRNTEX,PRITI,PROON,PROMIL,PCPL,PSRDL,PURFBR,PGD,PUREHN,MIG329,QDFS,QDPRNT,MIG330,QASAB,QSMYHL,QUANTM,QULTSN,RADES,MIG348,MIG338,MIG340,RRDECR,MIG347,RSHF,RBENT,RBFAB,RJC,RKD,MIG339,MIG342,MIG341,RABIAB,RKAPP,RADHAK,RADTEX,RAFTHL,RAGA,RAHUL,MIG331,RAJTEX,RJMDL,RCIJPR,RAJHAN,RJSPR,RAJOVR,Rajver,RAJSUG,RHKB,RKH,RMLPK,RM,RCIPL,RAMJID,MIG333,RAMZAN,MIG332,RANTEX,SWJA,RBRPL,RCILTD,RANIKA,RC,MIG334,RSHDHL,RKU,RTH,MIG335,RATNAM,RAVIEX,RAVITR,MIG336,RAVHL,MIG350,RAWMNG,RLCL,RAZIYA,MIG337,RDKRFB,REBATI,REHMHL,REHWA,RELIAN,REMAX,Resham,RESHMA,RIDAHL,RIYAFS,RKDERA,RKRISH,RKPOTR,RMC,RNG,MIG344,ROCK,ROEMLY,ROOTS,MIG346,ROPENT,MIG343,ROSHHL,MIG345,ROUH,RKSC,ROYAL,RPH,RSGRMT,SEWA,RUDOVS,rumm,RUQYHL,MIG349,MIG380,SRHLOM,MIG392,SSBENT,KLRTCC,MUDL,SSHLF,MIG367,SKFABR,SKTRMA,SLAXMI,MIG361,MIG390,MIG391,SSI,SAADH,SABALA,SFW,MIG353,SADAB,SADHNA,MIG395,SAFURA,SAHARA,SAHNI,SAHFAB,SAIHL,SAINIT,SAIKRS,MIG378,MIG389,SRC,SAIF,MIG365,SAIFHL,SAINI,MIG355,SAJWAT,SAJDHL,MIG356,SALART,MIG352,SLMHL,SALMAN,MIG357,SCI,SFF,SAMEER,SANAFN,SANDUR,MIG358,SANEFF,SANFAN,SATE,SNJIT,SGPL,SANS,SANTHI,MIG360,SAPPHL,SNF,SAQBHL,MIG388,SARAHL,SARG,SARKHL,MIG359,SBKOLI,SARTAJ,MIG398,SATORG,MIG354,SAGTF,SATYMF,SATENT,STM,SAEXPL,SSS,SKS,SERICR,SERICN,SEWALK,SEWTRD,SGSENG,SHBNHL,SHABIR,SHADHL,SHBZHL,SHAHBZ,MIG368,SHJHN,SHNZHL,SFC,SHAKIL,SKRH,SHKTEX,SHLMTX,MIG381,SHLMFS,SHALMR,MIG371,SHLM,MIG383,SHAMIM,Shamsu,SHARFT,SHARIF,siplca,SHARTS,MIG351,SHEEMA,SHEETL,SHEHNR,SHILPI,MIG382,SSFAB,SGI,SVINTL,SSF,MIG372,SHIVEN,MIG364,SHVAHL,SHVENT,MIG369,SVMCL,SHVPL,SRDCH,SHRJL,SHRAVN,SHRBEN,SHRCRN,SHRENT,SHRFAS,MIG431,SRGNSH,MIG198,SKI,SRSART,SSH,AVAN,MIG133,SBHU,GOVIND,MIG366,SHKMS,DIPESH,MIG394,SHRIAN,SHRIHP,SHUNYA,SHYAMA,MIG373,SHYIMP,SIGJEW,SILTEX,MIG374,SWC,STEX,SIVRCR,SIMFAB,SMRNSK,SINGEL,SIRTEX,MIG375,STI,SVAPHL,SIVASS,MIG396,SKCFI,SKTGR,MIG379,SKU,SKFS,MIG377,MIDAS,SHARE,SURE,MIG385,SFA,SOMTEX,SONIFN,MIG386,SOUMEN,SOUTH,MIG370,SHNHND,SOUVIK,SPRTAN,MIG387,SPHERI,MIG363,SPIRIT,SPRYDR,SQUR,SRCCR,SRGTEX,SRHL,SRIKAN,SSLKHL,SRIMAH,SRIRAM,MIG393,SRSHLM,SSCLOT,SUCMSL,MIG376,KANDAN,BDKL,SWE,STRCRF,MIG362,STRHLF,MIG397,SSIND,SCIPL,SUBAL,SURESH,SUHGTX,MIG400,SUHAIL,SUJATA,MIG401,SKRDL,MIG384,MIG402,SUMNTX,SUMRTX,SUMRTA,SUND,SUNIL,SUNRPR,SUPFSN,SUPRNT,SURAIY,SMPL,MIG403,SDGNPL,SHPRNT,MIG399,SURFAB,SURYA,SUTRA,MIG404,SWASTK,SBB,SWEX,SHCJA,SKK,TBJFAB,MIG407,TDSINC,TAJHL,MIG405,TAJHDL,TAJANS,TAKAHM,MIG411,TBKD,MIG412,TANV,TAPP,Tarakw,TARAEI,MIG131,TARAK,TRNCRT,TARION,TSNMTX,TAS,TWA,MIG408,TEJA,THRYML,Thanor,THECAR,COLNAT,CRAFTS,MIG409,CTEXT,ESTIND,TERI,MOKSHA,HWHICS,ICWC,MIG184,DIPTI,LUXCRF,MIG410,TSF,TSK,THEERS,TEPL,TNT,MIG406,THKB,TIRGAD,TTM,TOYJOY,TRENDS,TRPR,TRISTO,TEIPL,TUFAIL,MIG413,TULSIR,TUPT,UUMPCL,UJJAL,UTMT,UNICFT,MIG415,UPASLT,MIG416,UPASDS,UPRIND,MIG414,USHTEX,USHADY,MIG417,MIG120,USHATX,MIG418,UVESHL,MIG419,VCEXP,MIG424,VRTEXT,VMC,VDNJI,GOVMEG,VKLS,MAVJI,VANMEG,VANMUK,MURJI,NANJI,NITESH,PARBAT,PURSHO,SHAMJI,VARMOH,VARNLI,VARSHA,MIG421,Vedic,VCPL,VENENT,VEROVR,VGMCRF,Vidya,Vidha,VIDHYA,MIG420,MIG422,VIKENT,VHES,VINNER,VINOD,MIG423,VIRKJU,VISHAL,MIG426,VSNART,VIVALD,MIG425,VIVID,VKTEX,VKHL,WASEEM,WPAPER,WESTRN,WFBC,WLLAT,WGLAZE,WINGRN,WIFPL,WISLHL,WWCT,WIPL,WSL,YAHAYA,YSHTEX,YASMHL,MIG428,YOGITA,ZAIDHL,MIG432,zam,ZAMRUD,ZUBAIR,WEHAND,REVA,RLHND,GTC,EEPL,BNTCIL,ALFA,AIK";
                        cmd.Parameters.Add("@CompanyCode", SqlDbType.VarChar).Value = "10";
                        cmd.Parameters.Add("@inputProductHeirarchy", SqlDbType.VarChar).Value = "G~-1~-1~-1~-1~-1~-1~-1~-1~-1~-1~-1";
                        cmd.Parameters.Add("@FromDate", SqlDbType.DateTime).Value = new DateTime(2006, 1, 1);
                        cmd.Parameters.Add("@ToDate", SqlDbType.DateTime).Value = new DateTime(2019, 1, 21);
                        cmd.Parameters.Add("@longDesc", SqlDbType.NVarChar).Value = "-1";
                        cmd.Parameters.Add("@IsFopl", SqlDbType.VarChar).Value = "1";
                        cmd.Parameters.Add("@FoplSeasonality", SqlDbType.VarChar).Value = "-1";
                        cmd.Parameters.Add("@FoplStatus", SqlDbType.VarChar).Value = "-1";
                        cmd.Parameters.Add("@vMin", SqlDbType.BigInt).Value = 1;
                        cmd.Parameters.Add("@vMax", SqlDbType.BigInt).Value = 1000000000;
                        con.Open();
                        SqlDataAdapter sda = new SqlDataAdapter();
                        sda.SelectCommand = cmd;
                        sda.Fill(ds);
                    }
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return ds;
        }
    }
}
